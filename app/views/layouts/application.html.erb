<!DOCTYPE html>
<html>
<head>
  <title>Magiclord</title>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= yield :javascripts %>
  <%= csrf_meta_tags %>
  <% #check_path %>
</head>
<body>
<div class="pure-menu pure-menu-open pure-menu-horizontal">
  <ul>
    <li><%= link_to 'Home', root_path %></li>
    <li><%= link_to 'Guide', guide_index_path %></li>
    <% if user_signed_in? %>
        <% if have_character %>
            <li><%= link_to 'Character', new_character_path %></li>
            <li><%= link_to 'World', worlds_path %></li>
            <li><%= link_to 'Inventory', item_index_path %></li>
            <li><%= link_to 'Crafting', new_item_path %></li>
            <li><a href="#">Quest</a></li>
        <% else %>
            <li><%= link_to 'Character', new_character_path %></li>
        <% end %>
        <% if current_user.try(:admin?) %>
            <li class="pure-menu-can-have-children pure-menu-has-children">
              <a href="#" data-toggle="dropdown">Admin<span class="pure-custom-caret"></span></a>
              <ul class="pure-menu-children">
                <li><a href="/worlds/new">New World</a></li>
                <li><a href="/npc/new">New NPC</a></li>
                <li><a href="/magic_parts/new">New Magic Parts</a></li>
                <li><a href="/worlds/teleport">Teleport</a></li>
              </ul>
            </li>
        <% end %>
        <li><%= link_to 'Logout', logout_path %></li>
    <% else %>
        <li><%= link_to 'Login', login_path %></li>
    <% end %>

  </ul>
</div>
<p class="notice"><%= notice %></p>
<p class="alert"><%= alert %></p>
<% if user_signed_in?
     current_user
   end %>
<div class="pure-g">
  <div class="pure-u-1-3">
    <%= yield %>
  </div>
  <div class="pure-u-1-3">
    <h1>Console</h1>
    <div class="log" style="height:200px; border-style:solid; border-width:1px; overflow: scroll; font-size: 12px;">Log info that happens around the player</div>
    <input type="text" name="log" style="width:70%">
    <button style="width:20%">â˜º</button>
  </div>
  <% if user_signed_in? and have_character %>
      <div class="pure-u-1-3" id="stats_info">
        <% char = current_user.characters.where(Status: 1).first %>
        <h1><%= char.FirstName %></h1>
        <h2>Profile</h2>
        <p>Name: <%= char.FirstName.capitalize %> <%= char.LastName.capitalize %></p>
        <p>Age: <%= char.Age %></p>
        <p>Class: <%= char.Class.capitalize %></p>
        <p>Race: <%= char.Race.capitalize %></p>
        <p>Profession: <%= char.Primary_Profession.capitalize %>
          <% if !char.Secondary_Profession.nil? %>
             and <%= char.Secondary_Profession.capitalize %>
          <% end %>
        </p>
        <h2>Stats</h2>
        <p>Strength: <%= char.Strength %></p>
        <p>Agility: <%= char.Agility %></p>
        <p>Intelligence: <%= char.Intelligence %></p>
        <p>Stamina: <%= char.Stamina %></p>
        <h2>Condition</h2>
        <p>Health: <%= char.Curr_Hp %> / <%= max_health(char) %></p>
        <p>Stamina: <%= char.Curr_Stamina %> / <%= max_stamina(char) %></p>
        <h2>Buffs / Debuffs</h2>
        <% json = JSON.parse(char.effect) %>
        <% json.each do |effects| %>
            <% effects.each do |key, effect| %>
                <%= key %> do <%= effect["damage"] %> damage for <%= effect["turn"] %> more turns.
            <% end %>
        <% end %>
        <h2>Equipments</h2>
        <% inv = char.inventories.first %>
        <% inv.items.each do |item|%>
            <%= item.name %> (<%= item.equip %>)
            <% if item != inv.items.last %>
                <br/>
            <% end %>
        <% end %>
      </div>
  <% end %>
</div>
</body>
</html>